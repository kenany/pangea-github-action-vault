import PangeaConfig from "../config.js";
import PangeaRequest from "../request.js";
class BaseService {
    /*
    Required:
      - serviceName: name of the service
      - token: a token to use with the service
  
    Optional:
      - config: a PangeaConfig object, uses defaults if non passed
    */
    constructor(serviceName, token, config) {
        Object.defineProperty(this, "serviceName", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "isMultiConfigSupported", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        Object.defineProperty(this, "token", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "apiVersion", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "config", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "request_", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: undefined
        });
        if (!serviceName)
            throw new Error("A serviceName is required");
        if (!token)
            throw new Error("A token is required");
        this.serviceName = serviceName;
        this.apiVersion = "v1";
        this.token = token;
        this.config = new PangeaConfig({ ...config }) || new PangeaConfig();
    }
    async get(endpoint) {
        const fullpath = `${this.apiVersion}/${endpoint}`;
        return await this.request.get(fullpath);
    }
    async post(endpoint, data, options = {}) {
        const fullpath = `${this.apiVersion}/${endpoint}`;
        return await this.request.post(fullpath, data, options);
    }
    async postMultipart(endpoint, data, filepath, options = {}) {
        const fullpath = `${this.apiVersion}/${endpoint}`;
        return await this.request.postMultipart(fullpath, data, filepath, options);
    }
    async pollResult(request_id) {
        return await this.request.pollResult(request_id, true);
    }
    get request() {
        if (this.request_) {
            return this.request_;
        }
        this.request_ = new PangeaRequest(this.serviceName, this.token, this.config, this.isMultiConfigSupported);
        return this.request_;
    }
}
export default BaseService;
